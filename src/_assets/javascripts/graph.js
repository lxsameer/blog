
function draw_graph(){
    document.graphdata = [["2013-07-19",1],["2013-07-20",2],["2013-07-21",0],["2013-07-22",4],["2013-07-23",13],["2013-07-24",5],["2013-07-25",5],["2013-07-26",10],["2013-07-27",1],["2013-07-28",0],["2013-07-29",14],["2013-07-30",6],["2013-07-31",0],["2013-08-01",6],["2013-08-02",2],["2013-08-03",1],["2013-08-04",1],["2013-08-05",0],["2013-08-06",0],["2013-08-07",0],["2013-08-08",0],["2013-08-09",1],["2013-08-10",1],["2013-08-11",1],["2013-08-12",0],["2013-08-13",1],["2013-08-14",1],["2013-08-15",0],["2013-08-16",0],["2013-08-17",1],["2013-08-18",1],["2013-08-19",0],["2013-08-20",0],["2013-08-21",0],["2013-08-22",0],["2013-08-23",0],["2013-08-24",0],["2013-08-25",0],["2013-08-26",0],["2013-08-27",0],["2013-08-28",0],["2013-08-29",0],["2013-08-30",0],["2013-08-31",0],["2013-09-01",0],["2013-09-02",0],["2013-09-03",1],["2013-09-04",1],["2013-09-05",0],["2013-09-06",1],["2013-09-07",2],["2013-09-08",0],["2013-09-09",1],["2013-09-10",1],["2013-09-11",1],["2013-09-12",4],["2013-09-13",0],["2013-09-14",2],["2013-09-15",3],["2013-09-16",2],["2013-09-17",1],["2013-09-18",1],["2013-09-19",1],["2013-09-20",0],["2013-09-21",3],["2013-09-22",2],["2013-09-23",5],["2013-09-24",2],["2013-09-25",18],["2013-09-26",3],["2013-09-27",2],["2013-09-28",2],["2013-09-29",2],["2013-09-30",6],["2013-10-01",3],["2013-10-02",5],["2013-10-03",1],["2013-10-04",1],["2013-10-05",0],["2013-10-06",5],["2013-10-07",2],["2013-10-08",4],["2013-10-09",0],["2013-10-10",2],["2013-10-11",5],["2013-10-12",4],["2013-10-13",1],["2013-10-14",0],["2013-10-15",1],["2013-10-16",2],["2013-10-17",3],["2013-10-18",1],["2013-10-19",4],["2013-10-20",1],["2013-10-21",2],["2013-10-22",7],["2013-10-23",7],["2013-10-24",1],["2013-10-25",0],["2013-10-26",2],["2013-10-27",4],["2013-10-28",7],["2013-10-29",2],["2013-10-30",11],["2013-10-31",7],["2013-11-01",1],["2013-11-02",7],["2013-11-03",8],["2013-11-04",10],["2013-11-05",8],["2013-11-06",4],["2013-11-07",8],["2013-11-08",5],["2013-11-09",3],["2013-11-10",7],["2013-11-11",4],["2013-11-12",4],["2013-11-13",0],["2013-11-14",2],["2013-11-15",1],["2013-11-16",4],["2013-11-17",1],["2013-11-18",3],["2013-11-19",7],["2013-11-20",3],["2013-11-21",4],["2013-11-22",5],["2013-11-23",0],["2013-11-24",3],["2013-11-25",4],["2013-11-26",7],["2013-11-27",0],["2013-11-28",2],["2013-11-29",0],["2013-11-30",3],["2013-12-01",7],["2013-12-02",2],["2013-12-03",5],["2013-12-04",2],["2013-12-05",0],["2013-12-06",0],["2013-12-07",2],["2013-12-08",2],["2013-12-09",2],["2013-12-10",3],["2013-12-11",2],["2013-12-12",3],["2013-12-13",2],["2013-12-14",2],["2013-12-15",4],["2013-12-16",0],["2013-12-17",1],["2013-12-18",2],["2013-12-19",0],["2013-12-20",0],["2013-12-21",0],["2013-12-22",0],["2013-12-23",3],["2013-12-24",0],["2013-12-25",1],["2013-12-26",5],["2013-12-27",2],["2013-12-28",6],["2013-12-29",5],["2013-12-30",6],["2013-12-31",7],["2014-01-01",8],["2014-01-02",3],["2014-01-03",0],["2014-01-04",4],["2014-01-05",0],["2014-01-06",8],["2014-01-07",2],["2014-01-08",6],["2014-01-09",6],["2014-01-10",0],["2014-01-11",3],["2014-01-12",2],["2014-01-13",12],["2014-01-14",16],["2014-01-15",3],["2014-01-16",13],["2014-01-17",2],["2014-01-18",4],["2014-01-19",1],["2014-01-20",5],["2014-01-21",4],["2014-01-22",6],["2014-01-23",5],["2014-01-24",2],["2014-01-25",2],["2014-01-26",1],["2014-01-27",3],["2014-01-28",3],["2014-01-29",9],["2014-01-30",4],["2014-01-31",2],["2014-02-01",10],["2014-02-02",11],["2014-02-03",1],["2014-02-04",2],["2014-02-05",1],["2014-02-06",3],["2014-02-07",1],["2014-02-08",4],["2014-02-09",0],["2014-02-10",0],["2014-02-11",7],["2014-02-12",4],["2014-02-13",2],["2014-02-14",4],["2014-02-15",7],["2014-02-16",7],["2014-02-17",2],["2014-02-18",1],["2014-02-19",8],["2014-02-20",0],["2014-02-21",0],["2014-02-22",2],["2014-02-23",0],["2014-02-24",5],["2014-02-25",7],["2014-02-26",4],["2014-02-27",6],["2014-02-28",0],["2014-03-01",3],["2014-03-02",15],["2014-03-03",9],["2014-03-04",12],["2014-03-05",2],["2014-03-06",7],["2014-03-07",4],["2014-03-08",4],["2014-03-09",3],["2014-03-10",2],["2014-03-11",3],["2014-03-12",8],["2014-03-13",2],["2014-03-14",0],["2014-03-15",5],["2014-03-16",5],["2014-03-17",4],["2014-03-18",5],["2014-03-19",7],["2014-03-20",1],["2014-03-21",3],["2014-03-22",7],["2014-03-23",15],["2014-03-24",2],["2014-03-25",12],["2014-03-26",5],["2014-03-27",3],["2014-03-28",3],["2014-03-29",2],["2014-03-30",5],["2014-03-31",9],["2014-04-01",6],["2014-04-02",1],["2014-04-03",3],["2014-04-04",3],["2014-04-05",1],["2014-04-06",2],["2014-04-07",1],["2014-04-08",6],["2014-04-09",3],["2014-04-10",7],["2014-04-11",1],["2014-04-12",1],["2014-04-13",15],["2014-04-14",2],["2014-04-15",0],["2014-04-16",1],["2014-04-17",4],["2014-04-18",1],["2014-04-19",4],["2014-04-20",0],["2014-04-21",2],["2014-04-22",6],["2014-04-23",1],["2014-04-24",0],["2014-04-25",2],["2014-04-26",2],["2014-04-27",1],["2014-04-28",0],["2014-04-29",2],["2014-04-30",1],["2014-05-01",2],["2014-05-02",0],["2014-05-03",8],["2014-05-04",13],["2014-05-05",4],["2014-05-06",10],["2014-05-07",4],["2014-05-08",3],["2014-05-09",2],["2014-05-10",4],["2014-05-11",5],["2014-05-12",3],["2014-05-13",4],["2014-05-14",1],["2014-05-15",0],["2014-05-16",4],["2014-05-17",6],["2014-05-18",6],["2014-05-19",3],["2014-05-20",2],["2014-05-21",3],["2014-05-22",1],["2014-05-23",5],["2014-05-24",17],["2014-05-25",2],["2014-05-26",4],["2014-05-27",1],["2014-05-28",22],["2014-05-29",7],["2014-05-30",5],["2014-05-31",4],["2014-06-01",1],["2014-06-02",4],["2014-06-03",12],["2014-06-04",14],["2014-06-05",1],["2014-06-06",4],["2014-06-07",5],["2014-06-08",11],["2014-06-09",2],["2014-06-10",11],["2014-06-11",7],["2014-06-12",10],["2014-06-13",6],["2014-06-14",5],["2014-06-15",2],["2014-06-16",11],["2014-06-17",12],["2014-06-18",5],["2014-06-19",3],["2014-06-20",9],["2014-06-21",1],["2014-06-22",5],["2014-06-23",3],["2014-06-24",11],["2014-06-25",7],["2014-06-26",10],["2014-06-27",1],["2014-06-28",4],["2014-06-29",5],["2014-06-30",2],["2014-07-01",13],["2014-07-02",10],["2014-07-03",1],["2014-07-04",1],["2014-07-05",4],["2014-07-06",1],["2014-07-07",3],["2014-07-08",8],["2014-07-09",1],["2014-07-10",2],["2014-07-11",2],["2014-07-12",3],["2014-07-13",1],["2014-07-14",1],["2014-07-15",7],["2014-07-16",8],["2014-07-17",15],["2014-07-18",2],["2014-07-19",0]];
    var graphWidth = $(".graph").parent().width();
    var graphHeight = $(".graph").parent().height();
    var gutter = 2;

    var col_count = (graphWidth - 10) / (20 + gutter * 2);
    var rows = parseInt(document.graphdata.length / col_count);
    if  (document.graphdata.length % col_count > 0) {
        rows++;
    }

    console.log(col_count);
    console.log(rows);


    var maxBarHeight = 60;

    var max_commit = 0;

    _.each(document.graphdata, function(x){
        if (x[1] > max_commit) {
            max_commit = x[1];
        }
    });


    var yscale = d3.scale.linear()
            .domain([0, max_commit])
            .range([0, maxBarHeight]);

    var graph = d3.select(".graph")
            .style('width', graphWidth + 'px')
            .style('height', ((rows+1) * 20) + 'px')
            .selectAll('div')
            .data(document.graphdata)
            .enter().append("div")
            .style('width', '20px')
            .style('height', '20px')
            .style('opacity', function(data_element){
                var x = data_element[1];

                if (x == 0) {
                    return 0.1;
                }
                else if ((0 < x) && (x < 2)) {
                    return 0.2;
                }
                else if  ((2 < x) && (x < 7)) {
                    return 0.4;
                }
                else if  ((7 < x) && (x < 10)) {
                    return 0.6;
                }
                else if  ((10 < x) && (x < 12)) {
                    return 0.8;
                }
                else if  ((12 < x) && (x < 14)) {
                    return 0.95;
                }

                else {
                    return 1;
                }
            });

}

$(function(){
    draw_graph();
});
